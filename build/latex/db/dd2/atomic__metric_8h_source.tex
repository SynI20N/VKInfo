\hypertarget{atomic__metric_8h_source}{}\doxysection{atomic\+\_\+metric.\+h}
\label{atomic__metric_8h_source}\index{/home/leonid/Projects/VKInfo/VKInfoLib/include/atomic\_metric.h@{/home/leonid/Projects/VKInfo/VKInfoLib/include/atomic\_metric.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef ATOMIC\_METRIC\_H\_}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define ATOMIC\_METRIC\_H\_}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include <atomic>}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include <stdexcept>}}
\DoxyCodeLine{7 }
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include "{}metric.h"{}}}
\DoxyCodeLine{9 }
\DoxyCodeLine{10 \textcolor{keyword}{namespace }VkInfo \{}
\DoxyCodeLine{11 }
\DoxyCodeLine{12 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{13 \textcolor{keyword}{class }VKINFO\_API \mbox{\hyperlink{classVkInfo_1_1AtomicMetric}{AtomicMetric}} : \textcolor{keyword}{public} \mbox{\hyperlink{classVkInfo_1_1IMetric}{IMetric}} \{}
\DoxyCodeLine{14 \textcolor{keyword}{public}:}
\DoxyCodeLine{15     \mbox{\hyperlink{classVkInfo_1_1AtomicMetric}{AtomicMetric}}(\textcolor{keyword}{const} std::string\& name, T max, T min) }
\DoxyCodeLine{16         : name\_(name), value\_(0), max\_(max), min\_(min) \{\}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18     \textcolor{keywordtype}{void} set(T value)  \{}
\DoxyCodeLine{19         validate(value);}
\DoxyCodeLine{20         value\_ = value;}
\DoxyCodeLine{21     \}}
\DoxyCodeLine{22 }
\DoxyCodeLine{23     std::string get\_name()\textcolor{keyword}{ const override }\{}
\DoxyCodeLine{24         \textcolor{keywordflow}{return} name\_;}
\DoxyCodeLine{25     \}}
\DoxyCodeLine{26 }
\DoxyCodeLine{27     std::string get\_value\_and\_reset()\textcolor{keyword}{ override }\{}
\DoxyCodeLine{28         T val = value\_.exchange(0);}
\DoxyCodeLine{29         \textcolor{keywordflow}{return} std::to\_string(val);}
\DoxyCodeLine{30     \}}
\DoxyCodeLine{31 }
\DoxyCodeLine{32 \textcolor{keyword}{private}:}
\DoxyCodeLine{33     std::string name\_;}
\DoxyCodeLine{34     std::atomic<T> value\_;}
\DoxyCodeLine{35     T max\_;}
\DoxyCodeLine{36     T min\_;}
\DoxyCodeLine{37 }
\DoxyCodeLine{38     \textcolor{keywordtype}{void} validate(T\& value) \{}
\DoxyCodeLine{39         \textcolor{keywordflow}{if}(value > max\_) \{}
\DoxyCodeLine{40             \textcolor{keywordflow}{throw} std::domain\_error(\textcolor{stringliteral}{"{}metric value exceeds max value"{}});}
\DoxyCodeLine{41         \}}
\DoxyCodeLine{42         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(value < min\_) \{}
\DoxyCodeLine{43             \textcolor{keywordflow}{throw} std::domain\_error(\textcolor{stringliteral}{"{}metric value underflows"{}});}
\DoxyCodeLine{44         \}}
\DoxyCodeLine{45     \}}
\DoxyCodeLine{46 \};}
\DoxyCodeLine{47 }
\DoxyCodeLine{48 \} \textcolor{comment}{// namespace VkInfo}}
\DoxyCodeLine{49 }
\DoxyCodeLine{50 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// ATOMIC\_METRIC\_H\_}}

\end{DoxyCode}
